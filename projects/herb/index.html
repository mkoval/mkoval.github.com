---
layout: default
title: Planning, Perception, and Control for a Personal Robot - Projects - Michael Koval
category: projects
---

<h2>Planning, Perception, and Control for a Personal Robot</h2>
<p><a href="http://www.cmu.edu/herb-robot/">HERB</a>, the Home Exploring Robot
Butler, is a bi-manual mobile manipulator designed and built by the <a
href="https://www.personalrobotics.ri.cmu.edu/">Personal Robotics Lab</a> at <a
href="http://www.cmu.edu/">Carnegie Mellon University</a> to complete household
manipulation tasks. As a member of the Personal Robotics Lab, I developed many
of the planning, perception, and control algorithms used by HERB to
autonomously manipulate his environment.</p>

<p>I am the lead developer of
<a href="https://github.com/personalrobotics/herbpy">HerbPy</a> and
<a href="https://github.com/personalrobotics/prpy">PrPy</a>, the core Python
libraries used to control HERB. This software, developed in collaboration with
my colleagues in the Personal Robotics Lab, spans the spectrum of robotics,
including:</p>

<ul>
  <li>
    <p><strong>Motion Planning.</strong> I designed and implemented HERB's
    motion planning pipeline, which uses a repertoire motion planners, run in
    sequence, to quickly solve motion planning problem. He begins by planning
    with fast heuristics and, if that fails, falls back on more sophisticated
    algorithms.  These algorithms include a Jacobian-based controller,
    trajectory optimizers
    (<a href="https://www.ri.cmu.edu/publication_view.html?pub_id=7421">CHOMP</a> and
    <a href="http://rll.berkeley.edu/trajopt">Trajopt</a>), and
    sample-based motion planners
    (<a href="https://www.ri.cmu.edu/publication_view.html?pub_id=6309">CBiRRT</a> and
    <a href="http://lemur-planning.readthedocs.org/">LEMUR</a>).</p>

    <p>As part of this effort, I implemented
      <a href="https://github.com/personalrobotics/or_ompl">
        OpenRAVE bindings for the Open Motion Planning Library (OMPL)</a> and
      implemented a simple constrained motion planner that uses numerical
      integration to forward-simulate the execution of a Jacobian-based
      controller.</p>
  </li>
  <li>
    <p><strong>Multi-Step Planning.</strong> I implemented a backtracking
    search strategy, based on
    <a href="http://reports-archive.adm.cs.cmu.edu/anon/2015/abstracts/15-133.html">HGPC</a>, 
    to find geometrically feasible solutions to multi-step manipulation tasks.
    This framework allows HERB to reason about dependencies between steps of
    the task, e.g. choosing a poor position to place an object may make it
    impossible to complete later step of the task.
    </p>
  </li>
  <li><p><strong>Trajectory Post-Processing.</strong> Most geometric motion
    planners return un-timed piecewise linear paths that must be
    post-processed, via shortcutting and timing, before execution. I
    implemented this functionality by integrated a
    <a href="https://github.com/personalrobotics/or_parabolicsmoother">
      parabolic trajectory smoother</a> into HERB's motion planning pipeline.</p>

    <p>I implemented a framework that allows HERB to pipeline trajectory
    post-processing with execution to speed up execution of multi-step
    manipulation tasks. This is made possible by  annotating each path with all
    data necessary to post-process it without altering its feasibility; e.g.
    active constraints.</p>
  </li>
  <li><p><strong>Perception.</strong> I worked with perception experts in the
    Personal Robotics Lab to develop a standard interface for the object
    detection and pose estimation algorithms we use on HERB. We different
    perception algorithms to detect objects with different properties,
    including approaches based on feature matching
    (<a href="http://www.karlpauwels.com/simtrack/">SimTrack</a>),
    template matching (VNCC), and visual fiducials detection
    (<a href="https://april.eecs.umich.edu/wiki/index.php/AprilTags">Apriltag</a>).</p>
  </li>
  <li><p><strong>Control.</strong> I am the lead developer of a
    <a href="http://wiki.ros.org/ros_control">ros_control</a> interface for
    controlling HERB's Barrett WAM arms and BarrettHand end-effectors over CAN.
    This is a hard real-time controller that commands torques generated by an
    inverse dynamics controller at 500 Hz&ndash;1 kHZ. We plan to release this
    controller as open source software.</p>
</ul>

<p>We have used this software to make HERB complete a variety of tasks,
including: stocking a bookshelf, clearing a table,
<a href="http://www.post-gazette.com/life/lifestyle/2014/05/21/HERB-a-play-with-a-human-actor-aims-to-develop-natural-movements-for-androids/stories/201405190147">starring in a play</a>,
and completing a number of
<a href="http://arxiv.org/abs/1502.03143">YCB tasks</a>.  Videos of HERB
completing these tasks has been widely featured by the press, including
<a href="http://movies.nationalgeographic.com/movies/robots/">National Geographic's
<em>Robots</em> movie</a> shown in IMAX theaters,
<a href="http://www.cmu.edu/homepage/computing/2013/winter/cookie-vs-creme-a-robotic-twist.shtml">an Oreo cookie advertisement</a>, and
<a href="https://www.yahoo.com/katiecouric/pittsburgh-innovation-in-the-steel-city-204408302.html">an episode</a> of Katie Couric's <em>Cities Rising: Rebuilding America</em> series. Several highlight videos are included below</p>

<h3>Videos</h3>
<p>HERB has used the software I developed to complete a variety of <a
  href="http://arxiv.org/abs/1502.03143">YCB tasks</a>, including this block
sorting task. This task highlights HERB's motion planning and post-processing
pipelines. This task tasks place in a relatively open environment, so most
motion planning queries are solved by HERB's heuristic motion planning
algorithms.</p>
<p style="text-align:center;">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/hoO9brudboY"
          frameborder="0" allowfullscreen="allowfullscreen"></iframe>
</p>

<p>Tight integration between HERB's high-level software and his controller
allowed HERB to star in a play. I developed a controller plugin that allowed
HERB to natively execute
<a href="https://www.blender.org/manual/editors/graph_editor/fcurves.html">F-Curves</a>,
a type of Bezier curve produced by <a href="https://www.blender.org/">Blender</a>'s
animation tools. This allowed HERB to faithfully reproduce the animator's
intent.</p>

<p style="text-align:center;">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/pELAnSbeY-0"
          frameborder="0" allowfullscreen="allowfullscreen"></iframe>
</p>

<p>HERB has completed a variety of multi-stage manipulation tasks, such as
stocking a library, use all of HERB's capabilities. This task integrates all of
the techniques that I have described above.</p>

<p style="text-align:center;">
  <iframe width="560" height="315" src="https://www.youtube.com/embed/Bq5sblkoflM"
          frameborder="0" allowfullscreen="allowfullscreen"></iframe>
</p>
